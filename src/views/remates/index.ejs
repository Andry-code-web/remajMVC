<div class="banner_remates2" id="banner_remates">
    <div id="banner" class="overlay">
        <h1>REMATES</h1>
    </div>
</div>


<div class="prueva1">
    <!-- tarjeta v1 -->

    <div class="card">

        <div class="image-container">
            <img class="foto_casa"
                src="https://uiparadox.co.uk/public/templates/realtor/v2/assets/media/properties/property-1.png"
                alt="House Image">
            <a href="#" class="etiqueta_imagen">mas informacion</a>
            <img class="info_img" src="/img/imagen_pequeña_casa.png" alt="">
            <h6 class="info_img_tex">en venta</h6>
        </div>
        <a class="enlaces_carta" href="#">
            <div class="card-content">
                <h2>casa de campo</h2>
                <p class="address">110 hola mundo, nose donde queda</p>
                <p class="price">$90,000</p>
                <p class="details">4 habitacion | 2 Baños | 360 metros</p>
            </div>
        </a>
    </div>
    <div id="chat">
        <div id="chat-box" style="overflow-y: auto; max-height: 300px;"></div>
        <form id="chat-form">
          <input id="chat-input" type="text" placeholder="Escribe un mensaje" required />
          <button type="submit">Enviar</button>
        </form>
      </div>
      
</div>
<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();

    // Unirse a la sala de una subasta específica
    const auctionId = '<%= auction.id %>'; // Asegúrate de pasar el ID de la subasta desde el backend
    const username = '<%= user.username %>'; // Asegúrate de pasar el nombre del usuario

    socket.emit('join', { auctionId });

    // Enviar un mensaje de chat
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');
    const chatBox = document.getElementById('chat-box');

    chatForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const message = chatInput.value.trim();
        if (message) {
            socket.emit('chat-message', {
                auctionId,
                username,
                message,
            });
            chatInput.value = '';
        }
    });

    // Recibir mensajes de chat
    socket.on('chat-message', (data) => {
        const chatMessage = document.createElement('div');
        chatMessage.innerHTML = `<strong>${data.username}:</strong> ${data.message}`;
        chatBox.appendChild(chatMessage);
        chatBox.scrollTop = chatBox.scrollHeight; // Desplaza hacia abajo
    });

    // Cargar mensajes previos
    socket.on('load-messages', (messages) => {
        messages.forEach((msg) => {
            const chatMessage = document.createElement('div');
            chatMessage.innerHTML = `<strong>${msg.username}:</strong> ${msg.message}`;
            chatBox.appendChild(chatMessage);
        });
        chatBox.scrollTop = chatBox.scrollHeight;
    });
</script>